<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="夜行列车 - 一款叙事型Roguelike剧情模拟器">
    <title>夜行列车 | Night Train</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Film Grain Overlay -->
    <div class="film-grain"></div>

    <!-- Status Bar (Debug) -->
    <header class="status-bar">
        <div class="status-item">
            <span class="status-label">循环</span>
            <span class="status-value" id="stat-loop">1</span>
        </div>
        <div class="status-item">
            <span class="status-label">稳定度</span>
            <span class="status-value" id="stat-stability">80</span>
        </div>
        <div class="status-item">
            <span class="status-label">噪声</span>
            <span class="status-value" id="stat-noise">0</span>
        </div>
        <div class="status-item">
            <span class="status-label">信任</span>
            <span class="status-value" id="stat-trust">30</span>
        </div>
        <div class="status-item">
            <span class="status-label">觉察</span>
            <span class="status-value" id="stat-awareness">0</span>
        </div>
        <button class="btn-help" id="btn-help" title="帮助">?</button>
    </header>

    <!-- Main Game Container -->
    <main class="game-container">
        <!-- Full Screen Visual Area -->
        <section class="visual-panel">
            <div class="background-layer" id="background-layer">
                <div class="placeholder-bg">列车背景</div>
            </div>
            <div class="npc-layer" id="npc-layer"></div>

            <!-- Dialog Overlay (Galgame Style) -->
            <div class="dialog-overlay">
                <div class="dialog-header">
                    <h2 class="scene-title" id="scene-title">夜行列车</h2>
                    <span class="scene-npc" id="scene-npc"></span>
                </div>
                <div class="scene-text" id="scene-text">
                    <p>列车在无尽的夜色中穿行。你不记得自己是何时上车的，也不知道目的地在哪里。</p>
                </div>
                <div class="chat-input-area" id="chat-input-area">
                    <input type="text" id="chat-input" placeholder="输入你想说的话..." autocomplete="off">
                    <button id="btn-send-chat">发送</button>
                </div>
                <!-- Scene Navigation -->
                <div class="scene-nav" id="scene-nav">
                    <button class="nav-btn" id="btn-nav-prev" title="前一节车厢">← 前方车厢</button>
                    <button class="nav-btn" id="btn-nav-next" title="后一节车厢">后方车厢 →</button>
                </div>
            </div>
        </section>

        <!-- Choices Panel (Right Side) -->
        <aside class="choices-panel">
            <!-- Control Buttons (Top) -->
            <div class="panel-controls">
                <button class="btn-control" id="btn-history">📜 历史</button>
                <button class="btn-control" id="btn-bgm">🔇 BGM</button>
                <button class="btn-control" id="btn-new-game">新游戏</button>
                <button class="btn-control btn-danger" id="btn-clear-save">清空存档</button>
            </div>
            <div class="panel-divider"></div>
            <!-- Thoughts Container (Hint System) -->
            <div class="thoughts-container" id="thoughts-container">
                <div class="thoughts-header-row">
                    <span class="thoughts-header">你感觉有些事情还没弄明白...</span>
                    <span class="turn-counter" id="turn-counter" title="剩余对话次数">💬 15</span>
                </div>
                <ul class="thoughts-list" id="thoughts-list">
                    <!-- Dynamically populated -->
                </ul>
            </div>
            <div class="panel-divider"></div>
            <!-- Choices Container -->
            <div class="choices-container" id="choices-container">
                <!-- Choices will be inserted here -->
            </div>
        </aside>
    </main>

    <!-- Tutorial Overlay -->
    <div class="tutorial-overlay" id="tutorial-overlay">
        <div class="tutorial-card">
            <h1 class="tutorial-title">夜行列车</h1>

            <div class="tutorial-opening">
                <p>你睁开眼，发现自己坐在一列夜行列车上。</p>
                <p>窗外只有无尽的黑暗。你不记得自己为什么在这里。</p>
                <p class="tutorial-hint">但有一件事很清楚：这列车上的人，有人知道答案。</p>
            </div>

            <div class="tutorial-mechanics">
                <h3>🎮 如何游玩</h3>
                <div class="tutorial-mechanic-item">
                    <span class="mechanic-icon">💬</span>
                    <div class="mechanic-text">
                        <strong>自由对话</strong>：在底部输入框里输入任何话，与 NPC 交流
                    </div>
                </div>
                <div class="tutorial-mechanic-item">
                    <span class="mechanic-icon">🔘</span>
                    <div class="mechanic-text">
                        <strong>选择按钮</strong>：点击右侧的按钮执行特定动作或说特定的话
                    </div>
                </div>
                <div class="tutorial-mechanic-item">
                    <span class="mechanic-icon">🚃</span>
                    <div class="mechanic-text">
                        <strong>探索列车</strong>：用底部的「← 前方车厢」「后方车厢 →」切换位置
                    </div>
                </div>
            </div>

            <div class="tutorial-tips">
                <h3>💡 提示</h3>
                <p class="tutorial-tip">⏱️ 你有 <strong>15 次对话机会</strong>，之后列车将到站</p>
                <p class="tutorial-tip">🔄 到站后可再次登车，某些记忆会保留</p>
                <p class="tutorial-tip">🎭 游戏有 <strong>多个结局</strong>，取决于你的选择和发现</p>
                <p class="tutorial-tip">❓ 点击右上角 <strong>[?]</strong> 可随时查看帮助</p>
            </div>

            <div class="tutorial-goal">
                <p><strong>你的首要目标：</strong>找到你的车票，或者...找到离开的方法。</p>
            </div>

            <button class="btn-tutorial-start" id="btn-tutorial-start">开始探索</button>
        </div>
    </div>

    <!-- Ending Overlay -->
    <div class="ending-overlay" id="ending-overlay">
        <div class="ending-content">
            <h1 class="ending-title" id="ending-title">结局</h1>
            <p class="ending-description" id="ending-description">描述文本</p>
            <div class="ending-stats" id="ending-stats"></div>
            <button class="btn-next-loop" id="btn-next-loop">开始下一局</button>
        </div>
    </div>

    <!-- History Panel -->
    <div class="history-overlay" id="history-overlay">
        <div class="history-panel">
            <div class="history-header">
                <h2>对话历史</h2>
                <button class="btn-close-history" id="btn-close-history">×</button>
            </div>
            <div class="history-content" id="history-content">
                <!-- History items will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Audio Element -->
    <audio id="bgm" loop preload="auto">
        <!-- <source src="assets/audio/bgm.wav" type="audio/wav"> -->
    </audio>



    <script src="js/config.js"></script>
    <script src="js/main.js"></script>
</body>

</html>